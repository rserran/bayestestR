<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayes Factors (BF) for Order Restricted Models — bayesfactor_restricted • bayestestR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Bayes Factors (BF) for Order Restricted Models — bayesfactor_restricted" />

<meta property="og:description" content="This method computes Bayes factors for comparing a model with an order restrictions on its parameters
with the fully unrestricted model. Note that this method should only be used for confirmatory analyses.
 
For more info, see the Bayes factors vignette." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97457476-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97457476-7');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayestestR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Features</a>
</li>
<li>
  <a href="../articles/bayestestR.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/example1.html">1. Initiation to Bayesian models</a>
    </li>
    <li>
      <a href="../articles/example2.html">2. Confirmation of Bayesian skills</a>
    </li>
    <li>
      <a href="../articles/example3.html">3. Become a Bayesian master</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/credible_interval.html">Credible Intervals (CI)</a>
    </li>
    <li>
      <a href="../articles/region_of_practical_equivalence.html">Region of Practical Equivalence (ROPE)</a>
    </li>
    <li>
      <a href="../articles/probability_of_direction.html">Probability of Direction (pd)</a>
    </li>
    <li>
      <a href="../articles/bayes_factors.html">Bayes Factors (BF)</a>
    </li>
    <li>
      <a href="../articles/indicesEstimationComparison.html">Comparison of Point-Estimates</a>
    </li>
    <li>
      <a href="../articles/indicesExistenceComparison.html">Comparison of Indices of Effect Existence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/guidelines.html">Guidelines</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/easystats/bayestestR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayes Factors (BF) for Order Restricted Models</h1>
    <small class="dont-index">Source: <a href='https://github.com/easystats/bayestestR/blob/master/R/bayesfactor_restricted.R'><code>R/bayesfactor_restricted.R</code></a></small>
    <div class="hidden name"><code>bayesfactor_restricted.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This method computes Bayes factors for comparing a model with an order restrictions on its parameters
with the fully unrestricted model. <em>Note that this method should only be used for confirmatory analyses</em>.
<br /> <br />
For more info, see <a href='https://easystats.github.io/bayestestR/articles/bayes_factors.html'>the Bayes factors vignette</a>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>bayesfactor_restricted</span>(<span class='no'>posterior</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>hypothesis</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for stanreg</span>
<span class='fu'>bayesfactor_restricted</span>(<span class='no'>posterior</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>hypothesis</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>effects</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"fixed"</span>, <span class='st'>"random"</span>, <span class='st'>"all"</span>),
  <span class='no'>...</span>)

<span class='co'># S3 method for brmsfit</span>
<span class='fu'>bayesfactor_restricted</span>(<span class='no'>posterior</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>hypothesis</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>effects</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"fixed"</span>, <span class='st'>"random"</span>, <span class='st'>"all"</span>),
  <span class='no'>...</span>)

<span class='co'># S3 method for emmGrid</span>
<span class='fu'>bayesfactor_restricted</span>(<span class='no'>posterior</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>hypothesis</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>posterior</th>
      <td><p>A <code>stanreg</code> / <code>brmsfit</code> object, <code>emmGrid</code> or a data frame - representing a posterior distribution(s) from (see Details).</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>An object representing a prior distribution (see Details).</p></td>
    </tr>
    <tr>
      <th>hypothesis</th>
      <td><p>A character vector specifying the restrictions as logical conditions (see examples below).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Toggle off warnings.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently not used.</p></td>
    </tr>
    <tr>
      <th>effects</th>
      <td><p>Should results for fixed effects, random effects or both be returned?
Only applies to mixed models. May be abbreviated.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame containing the Bayes factor representing evidence <em>against</em> the un-restricted model.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This method is used to compute Bayes factors for order-restricted models vs un-restricted
models by setting an order restriction on the prior and posterior distributions
(<cite>Morey &amp; Wagenmakers, 2013</cite>).</p>
<p>(Though it is possible to use <code>bayesfactor_restricted</code> to test interval restrictions,
it is more suitable for testing order restrictions (see examples)).</p>
<p>When <code>posterior</code> is a model (<code>stanreg</code>, <code>brmsfit</code>), posterior and prior samples are
extracted for each parameter, and Savage-Dickey Bayes factors are computed for each parameter.</p>
<p><strong>NOTE:</strong> For <code>brmsfit</code> models, the model must have been fitted with <em>custom (non-default)</em> priors. See example below.</p>
<h3>Setting the correct <code>prior</code></h3>
    It is important to provide the correct <code>prior</code> for meaningful results.
<ul>
<li><p>When <code>posterior</code> is an <code>emmGrid</code> object based on a <code>stanreg</code> or <code>brmsfit</code> model, <code>prior</code> should be <em>that model object</em> (see example).</p></li>
<li><p>When <code>posterior</code> is a <code>stanreg</code> or <code>brmsfit</code> model, there is no need to specify <code>prior</code>, as prior samples are drawn internally.</p></li>
<li><p>When <code>posterior</code> is a <code>data.frame</code>, <code>prior</code> should also be a <code>data.frame</code>, with matching column names.</p></li>
</ul>
<h3>Interpreting Bayes Factors</h3>
    A Bayes factor greater than 1 can be interpereted as evidence against the null,
at which one convention is that a Bayes factor greater than 3 can be considered
as "substantial" evidence against the null (and vice versa, a Bayes factor
smaller than 1/3 indicates substantial evidence in favor of the null-hypothesis)
(<cite>Wetzels et al. 2011</cite>).
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <ul>
<li><p>Morey, R. D., &amp; Wagenmakers, E. J. (2014). Simple relation between Bayesian order-restricted and point-null hypothesis tests. Statistics &amp; Probability Letters, 92, 121-124.</p></li>
<li><p>Morey, R. D., &amp; Rouder, J. N. (2011). Bayes factor approaches for testing interval null hypotheses. Psychological methods, 16(4), 406.</p></li>
<li><p>Morey, R. D. (Jan, 2015). Multiple Comparisons with BayesFactor, Part 2 – order restrictions. Retrived from https://richarddmorey.org/category/order-restrictions/.</p></li>
</ul>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>bayestestR</span>)
<span class='no'>prior</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(
  <span class='kw'>X</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>),
  <span class='kw'>X1</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>),
  <span class='kw'>X3</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>)
)

<span class='no'>posterior</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(
  <span class='kw'>X</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>, <span class='fl'>.4</span>),
  <span class='kw'>X1</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>, -<span class='fl'>.2</span>),
  <span class='kw'>X3</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>)
)

<span class='no'>hyps</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(
  <span class='st'>"X &gt; X1 &amp; X1 &gt; X3"</span>,
  <span class='st'>"X &gt; X1"</span>
)

<span class='fu'>bayesfactor_restricted</span>(<span class='no'>posterior</span>, <span class='no'>prior</span>, <span class='kw'>hypothesis</span> <span class='kw'>=</span> <span class='no'>hyps</span>)</div><div class='output co'>#&gt; <span style='color: #0000BB;'># Bayes Factor (Order-Restriction)
#&gt; 
#&gt; </span><span>       Hypothesis P(Prior) P(Posterior) Bayes Factor
#&gt;  X &gt; X1 &amp; X1 &gt; X3     0.20         0.23         1.15
#&gt;            X &gt; X1     0.47         0.74         1.57
#&gt; 
#&gt; * Bayes factors for the restricted movel vs. the un-restricted model.</div></span><span class='co'># NOT RUN {</span>
<span class='co'># rstanarm models</span>
<span class='co'># ---------------</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>rstanarm</span>)
<span class='no'>fit_stan</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/rstanarm/topics/stan_glm'>stan_glm</a></span>(<span class='no'>mpg</span> ~ <span class='no'>wt</span> + <span class='no'>cyl</span> + <span class='no'>am</span>,
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mtcars</span>
)
<span class='no'>hyps</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(
  <span class='st'>"am &gt; 0 &amp; cyl &lt; 0"</span>,
  <span class='st'>"cyl &lt; 0"</span>,
  <span class='st'>"wt - cyl &gt; 0"</span>
)
<span class='fu'>bayesfactor_restricted</span>(<span class='no'>fit_stan</span>, <span class='kw'>hypothesis</span> <span class='kw'>=</span> <span class='no'>hyps</span>)

<span class='co'># emmGrid objects</span>
<span class='co'># ---------------</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>emmeans</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/options'>options</a></span>(<span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"contr.bayes"</span>, <span class='st'>"contr.bayes"</span>)) <span class='co'># see `bfrms` package</span>

<span class='co'># replicating http://bayesfactor.blogspot.com/2015/01/multiple-comparisons-with-bayesfactor-2.html</span>
<span class='no'>disgust_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.table</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/connections'>url</a></span>(<span class='st'>"http://www.learnbayes.org/disgust_example.txt"</span>), <span class='kw'>header</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='no'>fit_model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/rstanarm/topics/stan_glm'>stan_glm</a></span>(<span class='no'>score</span> ~ <span class='no'>condition</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>disgust_data</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/family'>gaussian</a></span>())

<span class='no'>em_condition</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/emmeans/topics/emmeans'>emmeans</a></span>(<span class='no'>fit_model</span>, ~<span class='no'>condition</span>)
<span class='no'>hyps</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"lemon &lt; control &amp; control &lt; sulfur"</span>)

<span class='fu'>bayesfactor_restricted</span>(<span class='no'>em_condition</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>fit_model</span>, <span class='kw'>hypothesis</span> <span class='kw'>=</span> <span class='no'>hyps</span>)
<span class='co'># &gt; # Bayes Factor (Order-Restriction)</span>
<span class='co'># &gt;</span>
<span class='co'># &gt;                          Hypothesis P(Prior) P(Posterior) Bayes Factor</span>
<span class='co'># &gt;  lemon &lt; control &amp; control &lt; sulfur     0.17         0.75         4.49</span>
<span class='co'># &gt; ---</span>
<span class='co'># &gt; Bayes factors for the restricted movel vs. the un-restricted model.</span>
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://dominiquemakowski.github.io/'>Dominique Makowski</a>, <a href='https://github.com/strengejacke'>Daniel Lüdecke</a>, <a href='https://github.com/mattansb'>Mattan S. Ben-Shachar</a>, <a href='http://www.humanfactors.io'>Michael D. Wilson</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

